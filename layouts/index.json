{{- $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections -}}
{{- $pages = first 10 $pages -}}
{
  "version": "https://jsonfeed.org/version/1",
  "title": {{ .Site.Title | jsonify }},
  "description": {{ .Site.Params.description | jsonify }},
  "home_page_url": {{ .Site.BaseURL | jsonify }},
  "feed_url": {{ printf "%s/index.json" .Site.BaseURL | jsonify }},
  "items": [
    {{- range $index, $page := $pages -}}
    {{- if $index }},{{ end }}
    {
      "id": {{ $page.Permalink | jsonify }},
      "url": {{ $page.Permalink | jsonify }},
      "title": {{ $page.Title | jsonify }},
      "content_text": {{ $page.Plain | jsonify }},
      "content_html": {{ $page.Content | jsonify }},
      "summary": {{ $page.Summary | jsonify }},
      "date_published": {{ $page.Date.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
      {{- if $page.Lastmod }}
      "date_modified": {{ $page.Lastmod.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
      {{- end }}
      {{- with $page.Params.tags }}
      "tags": {{ . | jsonify }},
      {{- end }}
      {{- with $page.Params.categories }}
      "categories": {{ . | jsonify }},
      {{- end }}
      "author": {
        "name": {{ .Site.Params.Author.name | default .Site.Title | jsonify }}
      }
    }
    {{- end }}
  ]
}