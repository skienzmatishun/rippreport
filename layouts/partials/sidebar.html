{{ $sidebar := .Site.Params.sidebar.default }}

{{ if eq .Kind "home" }}
    {{ $sidebar = default .Site.Params.sidebar.home .Params.sidebar }}
{{ else if eq .Kind "page" }}
    {{ $sidebar = default .Site.Params.sidebar.single .Params.sidebar }}
{{ else }}
    {{ $sidebar = default .Site.Params.sidebar.list .Params.sidebar }}
{{ end }}

{{ if $sidebar }}
<aside class="sidebar{{ if eq $sidebar "left" }} sidebar--left{{ end }}">
    <div id="mc_embed_shell">
        <link href="//cdn-images.mailchimp.com/embedcode/classic-061523.css" rel="stylesheet" type="text/css">
        <style type="text/css">
            #mc_embed_signup {
                background: #fff;
                clear: left;
                font: 14px Helvetica, Arial, sans-serif;
                width: 600px;
            }
        </style>
        <div style="width: 100%; background: #2d2f32; color: white; padding: 1.25em;" id="mc_embed_signup">
            <form action="https://rippreport.us17.list-manage.com/subscribe/post?u=98481555ada2777e9ee901545&amp;id=874f5e6494&amp;f_id=000f55e0f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank">
                <div id="mc_embed_signup_scroll">
                    <div class="mc-field-group">
                        <label for="mce-EMAIL">Email Address <span class="asterisk">*</span></label>
                        <input type="email" name="EMAIL" class="required email" id="mce-EMAIL" required="" value="">
                        <span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
                    </div>
                    <div id="mce-responses" class="clear foot">
                        <div class="response" id="mce-error-response" style="display: none;"></div>
                        <div class="response" id="mce-success-response" style="display: none;"></div>
                    </div>
                    <div style="position: absolute; left: -5000px;" aria-hidden="true">
                        <input type="text" name="b_98481555ada2777e9ee901545_874f5e6494" tabindex="-1" value="">
                    </div>
                    <div class="optionalParent">
                        <div class="clear foot">
                            <input type="submit" name="subscribe" id="mc-embedded-subscribe" class="btn" value="Subscribe" style="font-size: 1.25em; font-weight: 400;">
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script>
        <script type="text/javascript">
            (function($) {
                window.fnames = new Array();
                window.ftypes = new Array();
                fnames[0] = 'EMAIL';
                ftypes[0] = 'email';
                fnames[1] = 'FNAME';
                ftypes[1] = 'text';
                fnames[2] = 'LNAME';
                ftypes[2] = 'text';
                fnames[3] = 'BIRTHDAY';
                ftypes[3] = 'birthday';
            }(jQuery));
            var $mcj = jQuery.noConflict(true);
        </script>
    </div>
    <div class="backstory-sidebar">
        <div class="backstory-logo">
            <img src="https://rippreport.com/img/backstory-logo.jpg">
        </div>
        <div class="backstory-social">
            <a href="https://www.facebook.com/BackstoryPodcast/">{{ partial "svg/facebook.svg" (dict "id" "facebook") }}</a>
            <a style="margin-right: 10px;" href="https://rumble.com/user/BackstoryPodcast">{{ partial "svg/rumble.svg" (dict "id" "rumble") }}</a>
            <a href="mailto:backstory@rippreport.com">{{ partial "svg/email.svg" (dict "id" "email") }}</a>
        </div>
    </div>
    <iframe width="100%" height="450" scrolling="no" frameborder="no" allow="autoplay" style="opacity: .8" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/users/696620853&amp;color=%23ff5500&amp;auto_play=false&amp;hide_related=true&amp;show_comments=false&amp;show_user=false&amp;show_reposts=false&amp;show_teaser=false"></iframe>
	{{- $rssURL := "https://api.rss2json.com/v1/api.json?rss_url=https://www.lagniappemobile.com/search/?f=rss&t=article&c=site&l=50&s=start_time&sd=desc" -}}
{{- $numArticles := 8 -}}

{{- if eq .Kind "home" -}}
    {{- with getJSON $rssURL -}}
        <div class="torpedo-widget">
            <h2>Damn the Torpedoes - Lagniappe</h2>
            <ul>
                {{- range first $numArticles .items -}}
                    <li>
                        <a href="{{ .link }}">{{ .title }}</a>
                        <p>{{ .description }}</p>
                        <p>Published on {{ .pubDate }}</p>
                    </li>
                {{- end -}}
            </ul>
        </div>
    {{- end -}}
{{- end -}}
    {{- $root := . }}
    {{- with default .Site.Params.sidebar.widgets .Params.widgets }}
        {{- range $widget := . }}
            {{- $p := printf "widgets/%s.html" $widget }}
            {{- partial $p $root }}
        {{- end }}
    {{- else }}
        <p class="sidebar__warning"><strong>{{ T "sidebar_warning" }}:</strong><br>{{ T "sidebar_recommendation" }}</p>
    {{- end }}
</aside>
{{- end }}
