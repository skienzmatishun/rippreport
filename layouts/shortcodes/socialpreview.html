{{- $url := .Get "url" -}}
{{- $workerURL := (print "https://links.rippreport.com?q=" $url) -}}
{{- $json := getJSON $workerURL -}}

{{- if and (ne $json "No preview data found") (ne $json "Error processing request") }}
  {{- $parsedURL := urls.Parse $url -}}
  {{- $baseURL := $parsedURL.Host -}}
  {{- $title := replaceRE "\\u00A0" " " $json.title -}}
  {{- $description := replaceRE "\\u00A0" " " $json.description -}}
  <div class="social-preview">
    <a href="{{ $json.url }}">
      {{- $image := $json.image | default "https://rippreport.com/img/placeholder.png" -}}
      <img loading="lazy" src="{{ $image }}" alt="{{ $title }}">
      <h2>
        {{- if eq $baseURL "www.lagniappemobile.com" -}}
            {{ partial "svg/lagniappe.svg" (dict "id" "lagniappe") }}
            <br> {{ $title }}
        {{- else if eq $baseURL "www.al.com" -}}
            {{ partial "svg/alcom.svg" (dict "id" "alcom") }}
            <br> {{ $title }}
        {{- else if eq $baseURL "mynbc15.com" -}}
            {{ partial "svg/wpmi-logo.svg" (dict "id" "wpmi channel 15 news") }}
            <br> {{ $title }}
        {{- else if eq $baseURL "weartv.com" -}}
            {{ partial "svg/wear-logo.svg" (dict "id" "WearTV news") }}
            <br> {{ $title }}
        {{- else if eq $baseURL "1819news.com" -}}
            {{ partial "svg/1819news.svg" (dict "id" "1819 news") }}
            <br> {{ $title }}
        {{- else if eq $baseURL "rippreport.com" -}}
            {{ partial "svg/eagle-logo-preview.svg" (dict "id" "eagle-logo") }}
            <br> {{ $title }}
        {{- else if eq $baseURL "www.fox10tv.com" -}}
            {{ partial "svg/wala.svg" (dict "id" "Fox10") }}
            <br> {{ $title }}
        {{- else if eq $baseURL "www.montgomeryadvertiser.com" -}}
            {{ partial "svg/montgomery-advertiser.svg" (dict "id" "montgomeryadvertiser") }}
            <br> {{ $title }}
        {{- else if eq $baseURL "gulfcoastmedia.com" -}}
            <img loading="lazy" style="height:36px;width:150px;max-width:100%;min-height:36px;" src="https://rippreport.com/img/gulf-coast-media.png">
            <br> {{ $title | strings.TrimSuffix "- Gulf Coast Media" }}
        {{- else if eq $baseURL "www.gulfcoastnewstoday.com" -}}
            <img loading="lazy" style="height:36px;width:150px;max-width:100%;min-height:36px;" src="https://rippreport.com/img/gulf-coast-media.png">
            <br> {{ $title | strings.TrimSuffix "- Gulf Coast Media" }}
        {{- else if eq $baseURL "www.alreporter.com" -}}
            <img loading="lazy" style="height:46px;width:295px;max-width:100%;" src="https://rippreport.com/img/alreporter.png">
            <br> {{ $title }}
        {{- else if eq $baseURL "www.altoday.com" -}}
            <img loading="lazy" style="height:50px;width:85px;" src="https://rippreport.com/img/al_today.png">
            <br> {{ $title | strings.TrimSuffix "altoday.com" }}
        {{- else if eq $baseURL "thefairhopetimes.blogspot.com" -}}
            {{ $title }}
        {{- else -}}
            {{ $title }} <br> {{ $baseURL }}
        {{- end -}}
      </h2>
      <p>{{ $description }}</p>
      <span class="read_more">Read More</span>
    </a>
  </div>
{{- else -}}
  <div class="error-message">
    <p>Preview not available.</p>
    <a href="{{ $url }}">{{ $url }}</a>
  </div>
{{- end -}}
